<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Hitman Contract Search</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <style>
        body {
            padding-top: 50px;
        }

        .hidden {
            display: none;
        }

        .spinner {
            position: absolute;
            top: calc(50% - 5rem);
            left: calc(50% - 5rem);
            width: 10rem;
            height: 10rem;
        }
    </style>
    <script>
        function getContract() {
            document.getElementById('spinner').classList.remove('hidden');
            fetch(`./contract?platform=${document.getElementById('platform').value}&publicId=${document.getElementById('publicId').value}`)
                .then(response => response.json().then(contract => ({ contract, status: response.status})))
                .then(response => {
                    document.getElementById('contractTitle').innerText = response.contract.name;
                    document.getElementById('contractLocation').innerText = response.contract.location;
                    document.getElementById('contractBriefing').innerText = response.contract.description;
                    document.getElementById('contractId').innerText = response.contract.internalId;

                    response.status === 200 ? document.getElementById('results').classList.remove('hidden') : document.getElementById('results').classList.add('hidden');
                    response.status === 200 ? document.getElementById('results-hidden').classList.add('hidden') : document.getElementById('results-hidden').classList.remove('hidden');
                    document.getElementById('spinner').classList.add('hidden');
                });
        }
    </script>
</head>

<body>
    <div class="container">
        <div id="spinner" class="spinner-border spinner hidden" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <h1 style="text-align: center">Hitman Contract Search</h1>
        <div style="text-align: center">
            <select id="platform" style="height: 35px;">
                <option value="Epic">Epic</option>
                <option value="Steam">Steam</option>
                <option value="PlayStation">PlayStation</option>
                <option value="Stadia">Stadia</option>
                <!--
                    These don't work on the server yet :(
                    <option value="Switch">Switch</option>
                    <option value="Xbox">Xbox</option>
                -->
            </select>
            <input id="publicId" placeholder="Public Id" value="" style="line-height: 30px;" />
            <button onclick="getContract()" class="btn btn-primary" style="margin-top: -6px;">Get Contract</button>
        </div>

        <br />

        <div id="results" class="jumbotron hidden">
            <h2 id="contractTitle"></h1>
            <h3>Location</h2>
            <p id="contractLocation"></p>
            <h3>Briefing</h2>
            <p id="contractBriefing"></p>
            <h3>Contract ID</h2>
            <p id="contractId"></p>
        </div>

        <div id="results-hidden" class="jumbotron hidden" style="text-align: center;">
            <h1>No contract found</h1>
        </div>

        <div style="text-align: center;">Contract search is powered by <a href="https://www.hitmaps.com/" target="_blank">HITMAPS</a></div>
    </div>

</body>

</html>